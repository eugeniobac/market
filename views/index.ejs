<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    <h1>New Product</h1>
    
    <form id="new-product">
    	<input id="name" type="text" placeholder="Name of product"/>
    	<input id="price" type="number" placeholder="Price"/>
    	<input type="submit" value="Save" />
    </form>

    <h1>Last available product: </h1>
    
    <div id="last-product">

    </div>    

    <script src="/javascripts/jquery-1.11.0.min.js" type="text/javascript"></script>
    <script src="/socket.io/socket.io.js" type="text/javascript"></script>

    <script type="text/javascript">
    	$(function(){

    		var socket = io.connect(document.URL);

            socket.on("new-product-available", function(product){
                console.log("there is a new product available");
                console.log(product);

                var content = product.name + " for " + product.price;
                $("#last-product").html(content);
            });

    		$("#new-product").submit(function(event){
    			var name = $("#name").val();
				var price = $("#price").val();

				var product = {
					"name" : name,
					"price" : price
				};

				console.log("Saving product " + name + "/" + price);
				socket.emit("new-product", product);
    			event.preventDefault();
    		});
    	});
    </script>
  </body>
</html>
